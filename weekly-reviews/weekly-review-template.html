<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Philippine News Review: Week of [DATE RANGE], 2026</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600&family=Spectral:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      * { box-sizing: border-box; margin: 0; padding: 0; }

      body {
        font-family: "Spectral", Georgia, serif;
        color: #222;
        background: #fdfcfb;
        line-height: 1.6;
        min-height: 100vh;
      }

      header {
        padding: 3rem 1.5rem 1.5rem;
        max-width: 800px;
        margin: 0 auto;
      }

      .header-nav {
        font-size: 0.8125rem;
        font-family: "IBM Plex Sans", -apple-system, sans-serif;
        margin-bottom: 1.5rem;
      }

      .header-nav a {
        color: #666;
        text-decoration: none;
      }

      .header-nav a:hover {
        text-decoration: underline;
      }

      h1 {
        font-size: 1.75rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
      }

      .week-range {
        font-size: 1rem;
        color: #666;
        margin: 0 0 1.5rem;
      }

      .nav-links {
        display: flex;
        gap: 1.5rem;
        flex-wrap: wrap;
        font-family: "IBM Plex Sans", -apple-system, sans-serif;
        font-size: 0.875rem;
      }

      .nav-links a {
        color: #222;
        text-decoration: underline;
        text-underline-offset: 2px;
      }

      .nav-links a:hover {
        color: #000;
      }

      main {
        max-width: 800px;
        margin: 0 auto;
        padding: 0 1.5rem 4rem;
      }

      .summary-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 1rem;
        margin: 1.5rem 0 2rem;
        padding: 1rem;
        background: #fff;
        border: 1px solid #e5e5e5;
      }

      .stat-card {
        text-align: center;
      }

      .stat-card .number {
        font-size: 1.5rem;
        font-weight: 600;
        color: #222;
        margin: 0;
        font-family: "IBM Plex Sans", -apple-system, sans-serif;
      }

      .stat-card .label {
        font-size: 0.6875rem;
        color: #888;
        margin: 0.25rem 0 0;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        font-family: "IBM Plex Sans", -apple-system, sans-serif;
      }

      .section {
        margin: 2rem 0;
      }

      .section-title {
        font-family: "IBM Plex Sans", -apple-system, sans-serif;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        color: #888;
        margin: 0 0 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 1px solid #e5e5e5;
      }

      .event {
        background: #fff;
        border: 1px solid #e5e5e5;
        padding: 1rem 1.25rem;
        margin-bottom: 1rem;
      }

      .event-header {
        display: flex;
        gap: 0.75rem;
        align-items: center;
        margin-bottom: 0.5rem;
        flex-wrap: wrap;
      }

      .event time {
        font-family: "IBM Plex Sans", -apple-system, sans-serif;
        font-size: 0.75rem;
        color: #888;
      }

      .category-badge {
        padding: 0.125rem 0.5rem;
        font-size: 0.625rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        font-weight: 600;
        border: 1px solid;
        font-family: "IBM Plex Sans", -apple-system, sans-serif;
      }

      .category-badge.political {
        color: #3a0ca3;
        border-color: #3a0ca3;
      }

      .category-badge.cultural {
        color: #b23a48;
        border-color: #b23a48;
      }

      .category-badge.natural-disasters {
        color: #0b6e4f;
        border-color: #0b6e4f;
      }

      .category-badge.economic {
        color: #3a0ca3;
        border-color: #3a0ca3;
      }

      .category-badge.legal {
        color: #1e3a5f;
        border-color: #1e3a5f;
      }

      .category-badge.international-relations {
        color: #0d7377;
        border-color: #0d7377;
      }

      .category-badge.religious {
        color: #b45309;
        border-color: #b45309;
      }

      .event h2 {
        margin: 0 0 0.5rem;
        font-size: 1rem;
        font-weight: 600;
      }

      .event h2 a {
        color: #222;
        text-decoration: none;
      }

      .event h2 a:hover {
        text-decoration: underline;
      }

      .event .description {
        font-size: 0.875rem;
        color: #444;
        margin: 0.5rem 0;
        line-height: 1.6;
      }

      .event-details {
        margin-top: 0.75rem;
        padding-top: 0.75rem;
        border-top: 1px solid #e5e5e5;
      }

      .event-details p {
        margin: 0.5rem 0;
        font-size: 0.8125rem;
        line-height: 1.5;
      }

      .event-details strong {
        color: #222;
        font-weight: 600;
      }

      .significance {
        padding: 0.75rem;
        background: #f9f9f9;
        border-left: 2px solid #ddd;
        margin: 0.75rem 0;
        font-size: 0.8125rem;
      }

      .diaspora-impact {
        padding: 0.75rem;
        background: #f9f9f9;
        border-left: 2px solid #ddd;
        margin: 0.75rem 0;
        font-size: 0.8125rem;
      }

      .dynasties {
        margin: 0.75rem 0;
        padding: 0.75rem;
        background: #f9f9f9;
        border-left: 2px solid #3a0ca3;
        font-size: 0.8125rem;
      }

      .dynasties a {
        color: #3a0ca3;
        text-decoration: none;
        font-weight: 500;
      }

      .dynasties a:hover {
        text-decoration: underline;
      }

      .sources {
        margin: 0.75rem 0;
        font-size: 0.8125rem;
      }

      .sources a {
        color: #222;
        text-decoration: underline;
        text-underline-offset: 2px;
        margin-right: 0.5rem;
      }

      .sources a:hover {
        color: #000;
      }

      .dynasty-highlights {
        background: #fff;
        border: 1px solid #e5e5e5;
        padding: 1.25rem;
        margin: 2rem 0;
      }

      .dynasty-highlights h3 {
        font-family: "IBM Plex Sans", -apple-system, sans-serif;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        color: #888;
        margin: 0 0 1rem;
      }

      .dynasty-item {
        padding: 0.75rem;
        margin: 0.5rem 0;
        background: #f9f9f9;
        border-left: 2px solid #3a0ca3;
        font-size: 0.875rem;
      }

      .dynasty-item a {
        color: #3a0ca3;
        text-decoration: none;
        font-weight: 600;
      }

      .dynasty-item a:hover {
        text-decoration: underline;
      }

      footer {
        max-width: 800px;
        margin: 0 auto;
        padding: 2rem 1.5rem;
        text-align: center;
        color: #888;
        font-size: 0.75rem;
        border-top: 1px solid #e5e5e5;
        font-family: "IBM Plex Sans", -apple-system, sans-serif;
      }

      footer a {
        color: #666;
        text-decoration: none;
      }

      footer a:hover {
        text-decoration: underline;
      }

      .empty-state {
        padding: 3rem;
        text-align: center;
        color: #888;
        border: 1px dashed #ddd;
        background: #fff;
      }

      @media (max-width: 640px) {
        header, main, footer {
          padding-left: 1.25rem;
          padding-right: 1.25rem;
        }

        .summary-stats {
          grid-template-columns: repeat(2, 1fr);
        }
      }
    </style>
  </head>
  <body>
    <header>
      <nav class="header-nav"><a href="../">← OpenPinas</a> · <a href="index.html">Weekly Reviews</a></nav>
      <h1>Philippine News Review</h1>
      <p class="week-range">Week of [START DATE] - [END DATE], 2026</p>
      <nav class="nav-links">
        <a href="../interactive-timeline/">Full Timeline</a>
        <a href="../dynasties-network-visualization.html">Dynasty Map</a>
      </nav>
    </header>

    <main>
      <section class="summary-stats">
        <div class="stat-card">
          <p class="number" id="total-events">0</p>
          <p class="label">Total Events</p>
        </div>
        <div class="stat-card">
          <p class="number" id="political-count">0</p>
          <p class="label">Political</p>
        </div>
        <div class="stat-card">
          <p class="number" id="disaster-count">0</p>
          <p class="label">Disasters</p>
        </div>
        <div class="stat-card">
          <p class="number" id="dynasty-count">0</p>
          <p class="label">Dynasties</p>
        </div>
      </section>

      <section id="events-container">
        <div class="empty-state">
          <p>Loading events for this week...</p>
        </div>
      </section>

      <section class="dynasty-highlights" id="dynasty-highlights">
        <h3>Dynasty Highlights</h3>
        <div id="dynasty-content">
          <p>No significant dynasty news this week.</p>
        </div>
      </section>
    </main>

    <footer>
      <p>Part of <a href="../">OpenPinas</a></p>
      <p><a href="https://github.com/dat-angel/openpinas">GitHub</a> · Data: CC BY 4.0</p>
      <p style="margin-top: 0.75rem;">Last updated: <span id="last-updated">[DATE]</span></p>
    </footer>

    <script>
      // Configuration - Update these for each week
      const WEEK_CONFIG = {
        startDate: "2026-01-05",
        endDate: "2026-01-11",
        timelineFile: "../philippines-2026-timeline.json",
        weekLabel: "January 5-11, 2026"
      };

      // Category mapping
      const categoryMap = {
        "Political": { slug: "political", display: "Political" },
        "Cultural": { slug: "cultural", display: "Cultural" },
        "Natural Disasters": { slug: "natural-disasters", display: "Natural Disasters" },
        "Economic": { slug: "economic", display: "Economic" },
        "Legal": { slug: "legal", display: "Legal" },
        "International Relations": { slug: "international-relations", display: "International Relations" },
        "Religious": { slug: "religious", display: "Religious" }
      };

      function formatDate(dateString) {
        const date = new Date(dateString + "T00:00:00");
        return date.toLocaleDateString("en-US", {
          month: "long",
          day: "numeric",
          year: "numeric"
        });
      }

      function formatDateForURL(dateString) {
        return dateString;
      }

      function getDynastyName(id) {
        const names = {
          "MARCOS_ROMUALDEZ": "Marcos-Romualdez",
          "DUTERTE_FAMILY": "Duterte",
          "AQUINO_FAMILY": "Aquino",
          "REVILLA_TOLENTINO": "Revilla-Tolentino",
          "ESTRADA_FAMILY": "Estrada",
          "VILLAR_FAMILY": "Villar",
          "PACQUIAO_FAMILY": "Pacquiao",
          "SINGSON_FAMILY": "Singson",
          "ORTEGA_FAMILY": "Ortega",
          "TULFO_FAMILY": "Tulfo",
          "LACSON_FAMILY": "Lacson",
          "GO_FAMILY": "Go",
          "DELA_ROSA_FAMILY": "Dela Rosa",
          "BINAY_FAMILY": "Binay"
        };
        return names[id] || id.replace(/_/g, " ");
      }

      function createEventHTML(event) {
        const category = categoryMap[event.category] || { slug: "political", display: event.category };

        let dynastiesHTML = "";
        if (event.mentioned_dynasties && event.mentioned_dynasties.length > 0) {
          const dynastyLinks = event.mentioned_dynasties.map(id => {
            const name = getDynastyName(id);
            return `<a href="../dynasties-network-visualization.html#dynasty-${id}">${name}</a>`;
          }).join(", ");
          dynastiesHTML = `<div class="dynasties"><strong>Dynasties:</strong> ${dynastyLinks}</div>`;
        }

        let sourcesHTML = "";
        const allSources = [
          ...(event.sources?.international || []),
          ...(event.sources?.local || [])
        ];
        if (allSources.length > 0) {
          const sourceLinks = allSources.map((url) => {
            const domain = new URL(url).hostname.replace("www.", "");
            return `<a href="${url}" target="_blank" rel="noopener">${domain}</a>`;
          }).join(" ");
          sourcesHTML = `<div class="sources"><strong>Sources:</strong> ${sourceLinks}</div>`;
        }

        return `
          <article class="event" data-category="${category.slug}" data-date="${event.date}">
            <div class="event-header">
              <time datetime="${event.date}">${formatDate(event.date)}</time>
              <span class="category-badge ${category.slug}">${category.display}</span>
            </div>
            <h2>
              <a href="../interactive-timeline/?date=${formatDateForURL(event.date)}&search=${encodeURIComponent(event.title)}">
                ${event.title}
              </a>
            </h2>
            <p class="description">${event.description}</p>
            <div class="event-details">
              ${event.significance ? `<p class="significance"><strong>Significance:</strong> ${event.significance}</p>` : ""}
              ${event.diaspora_impact ? `<p class="diaspora-impact"><strong>Diaspora Impact:</strong> ${event.diaspora_impact}</p>` : ""}
              ${dynastiesHTML}
              ${sourcesHTML}
            </div>
          </article>
        `;
      }

      function groupEventsByCategory(events) {
        const grouped = {};
        events.forEach(event => {
          const category = event.category || "Political";
          if (!grouped[category]) {
            grouped[category] = [];
          }
          grouped[category].push(event);
        });
        return grouped;
      }

      function renderEvents(events) {
        const container = document.getElementById("events-container");

        if (events.length === 0) {
          container.innerHTML = `
            <div class="empty-state">
              <p>No significant events recorded for this week.</p>
            </div>
          `;
          return;
        }

        const grouped = groupEventsByCategory(events);
        const categoryOrder = ["Political", "Natural Disasters", "Economic", "Legal", "International Relations", "Cultural", "Religious"];

        let html = "";
        categoryOrder.forEach(category => {
          if (grouped[category] && grouped[category].length > 0) {
            html += `<section class="section">
              <h2 class="section-title">${category}</h2>
              ${grouped[category].map(event => createEventHTML(event)).join("")}
            </section>`;
          }
        });

        container.innerHTML = html;
      }

      function updateStats(events) {
        const political = events.filter(e => e.category === "Political" || e.category === "Economic" || e.category === "Legal" || e.category === "International Relations").length;
        const disasters = events.filter(e => e.category === "Natural Disasters").length;
        const dynasties = new Set();
        events.forEach(event => {
          if (event.mentioned_dynasties) {
            event.mentioned_dynasties.forEach(id => dynasties.add(id));
          }
        });

        document.getElementById("total-events").textContent = events.length;
        document.getElementById("political-count").textContent = political;
        document.getElementById("disaster-count").textContent = disasters;
        document.getElementById("dynasty-count").textContent = dynasties.size;
      }

      function renderDynastyHighlights(events) {
        const container = document.getElementById("dynasty-content");
        const dynastyEvents = events.filter(e => e.mentioned_dynasties && e.mentioned_dynasties.length > 0);

        if (dynastyEvents.length === 0) {
          container.innerHTML = "<p>No significant dynasty news this week.</p>";
          return;
        }

        const dynastyMap = {};
        dynastyEvents.forEach(event => {
          event.mentioned_dynasties.forEach(id => {
            if (!dynastyMap[id]) {
              dynastyMap[id] = [];
            }
            dynastyMap[id].push(event);
          });
        });

        let html = "";
        Object.keys(dynastyMap).sort().forEach(id => {
          const name = getDynastyName(id);
          const relatedEvents = dynastyMap[id];
          html += `
            <div class="dynasty-item">
              <strong><a href="../dynasties-network-visualization.html#dynasty-${id}">${name}</a></strong>
              <ul style="margin: 0.5rem 0 0 1.25rem; padding: 0;">
                ${relatedEvents.map(e => `<li><a href="../interactive-timeline/?date=${formatDateForURL(e.date)}">${e.title}</a></li>`).join("")}
              </ul>
            </div>
          `;
        });

        container.innerHTML = html;
      }

      async function loadWeekReview() {
        try {
          document.title = `Philippine News Review: Week of ${WEEK_CONFIG.weekLabel}`;
          document.querySelector(".week-range").textContent = `Week of ${WEEK_CONFIG.weekLabel}`;
          document.getElementById("last-updated").textContent = new Date().toLocaleDateString("en-US", {
            year: "numeric",
            month: "long",
            day: "numeric"
          });

          const response = await fetch(WEEK_CONFIG.timelineFile);
          if (!response.ok) {
            throw new Error(`Failed to load timeline: ${response.statusText}`);
          }

          const data = await response.json();
          const timeline = data.timeline || [];

          const weekEvents = timeline.filter(event => {
            const eventDate = event.date;
            return eventDate >= WEEK_CONFIG.startDate && eventDate <= WEEK_CONFIG.endDate;
          });

          weekEvents.sort((a, b) => a.date.localeCompare(b.date));

          renderEvents(weekEvents);
          updateStats(weekEvents);
          renderDynastyHighlights(weekEvents);

        } catch (error) {
          console.error("Error loading week review:", error);
          document.getElementById("events-container").innerHTML = `
            <div class="empty-state">
              <p>Error loading events: ${error.message}</p>
              <p style="margin-top: 0.75rem; font-size: 0.8125rem;">
                Make sure the timeline JSON file exists at: ${WEEK_CONFIG.timelineFile}
              </p>
            </div>
          `;
        }
      }

      loadWeekReview();
    </script>
  </body>
</html>
